var AutoLayout;(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{main:()=>g});var n=document.body&&document.body.clientHeight,o=document.body&&document.body.clientWidth,i=document.body&&.01*document.body.clientWidth,a=document.body&&.1*document.body.clientWidth;function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var l=function(){function t(e,n,o,i,a,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ruleList=e,this.nodeList=n,this.sumHeight=i,this.sumWidth=o,this.isAllChild=a,this.parentNode=r}var e,n;return e=t,(n=[{key:"getNodeMedia",value:function(){return document.querySelector("style#vivo_media")}},{key:"setParentWidth",value:function(){for(var t=this.parentNode;t.parentNode&&"BODY"!=t.parentNode.tagName;){var e=s.getStyleId();(t=t.parentNode).getAttribute("vivo-height")||(t.setAttribute("vivo-parent","layout-".concat(e)),s.setStyleMap(e,{"vivo-parent":"[vivo-parent='layout-".concat(e,"'] {height:auto!important;min-height:auto!important;}")}))}}},{key:"layout1",value:function(){return!!this.ruleList.includes("layout1")&&(console.log("\u573a\u666f1====",this.nodeList),this.nodeList.map((function(t){var e=s.getStyleId();s.isZoom(t,"vivo-1-1")||(t.setAttribute("vivo-layout","layout1"),t.setAttribute("vivo-1-1","layout-".concat(e)),s.setStyleMap(e,{"vivo-1-1":"[vivo-1-1='layout-".concat(e,"'] {width:").concat(t.clientWidth,"px!important;height:auto!important;margin:auto!important;padding:auto!important;flex:0 0 auto!important;}")}))})),this.parentNode.setAttribute("vivo-1","layout-1"),s.setStyleMap("vivo-1-1",{"vivo-1-1":"[vivo-1='layout-1'] {display:flex!important;zoom:0.5!important;flex-wrap:nowrap!important;justify-content:space-between!important;}"}),this.parentNode.setAttribute("vivo-zoom",""),this.setParentWidth(),!0)}},{key:"layout2",value:function(){return!!this.ruleList.includes("layout2")&&(console.log("\u573a\u666f2====",this.nodeList),this.nodeList.map((function(t){var e=s.getStyleId();s.isZoom(t,"vivo-2-2")||(t.setAttribute("vivo-layout","layout2"),t.setAttribute("vivo-2-2","layout-".concat(e)),s.setStyleMap(e,{"vivo-2-2":"[vivo-2-2='layout-".concat(e,"'] {width:").concat(o-i,"px!important;margin:auto!important;padding:auto!important;}")}))})),this.parentNode.setAttribute("vivo-2","layout-2"),s.setStyleMap("vivo-2",{"vivo-2":"[vivo-2='layout-2'] {display:flex!important;zoom:0.5!important;align-items:center!important;flex-wrap:wrap!important;justify-content:space-between!important;flex:0 0 auto!important;}"}),this.setParentWidth(),!0)}},{key:"layout3",value:function(){var t=this;if(!this.ruleList.includes("layout3"))return!1;console.log("\u573a\u666f3====",this.nodeList),this.nodeList.map((function(e){var n=s.getStyleId();s.isZoom(e,"vivo-3-3")||(e.setAttribute("vivo-layout","layout3"),e.setAttribute("vivo-3-3","layout-".concat(n)),s.setStyleMap(n,{"vivo-3-3":"[vivo-3-3='layout-".concat(n,"'] {width:").concat(t.parentNode.clientWidth-2*i,"px!important;margin:0!important;flex:0 0 auto!important;}")}))}));var e=document.createElement("div");return this.parentNode.insertBefore(e,this.nodeList[0]),this.nodeList.map((function(t){return e.appendChild(t)})),e.setAttribute("vivo-3","layout-3"),s.setStyleMap("vivo-3",{"vivo-3":"[vivo-3='layout-3'] {display:flex!important;zoom:0.5!important;flex-wrap:wrap!important;justify-content:space-between!important;}"}),!0}},{key:"layout4",value:function(t){try{var e=s.getStyleId();s.isZoom(t,"vivo-padding_margin")||(t.setAttribute("vivo-padding_margin","layout-".concat(e)),s.setStyleMap(e,{"vivo-padding_margin":"[vivo-padding_margin='layout-".concat(e,"'] {margin:").concat(s.parseNodePaddingAndMargin(t)[0],"!important;padding:").concat(s.parseNodePaddingAndMargin(t)[1],"!important}")}))}catch(t){}Array.from(t.children).map((function(t){if(!s.isZoom(t,"vivo-children")&&!t.getAttribute("vivo-zoom")&&!s.isFullWidth(t)&&t.clientHeight){var e=s.getStyleId();t.setAttribute("vivo-children","layout-".concat(e)),s.setStyleMap(e,{"vivo-children":"[vivo-children='layout-".concat(e,"']  {height:").concat(.8*t.clientHeight,"px!important;}")}),t.setAttribute("vivo-zoom","true"),Array.from(t.querySelectorAll("img")).map((function(t){var e=s.getStyleId();!t.getAttribute("vivo-zoom")&&t.clientHeight&&(t.setAttribute("vivo-img","layout-".concat(e)),s.setStyleMap(e,{"vivo-img":"[vivo-img='layout-".concat(e,"']  {height:").concat(.8*t.clientHeight,"px!important;}")}),t.setAttribute("vivo-zoom","true"))}))}}))}},{key:"zoomFont",value:function(){for(var t=[],e=document.createTreeWalker(document.body,NodeFilter.SHOW_ALL,{acceptNode:function(t){return null!=t&&t.getAttribute&&t.getAttribute("vivo-layout")?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}},!0),n=e.nextNode();null!=n;)"Text"==n.constructor.name&&t.push(n.parentNode),n=e.nextNode();t.length&&t.map((function(t){if(!s.isZoom(t,"vivo-font")){var e=s.getStyleId(),n=getComputedStyle(t),o=parseFloat(n.fontSize);t.setAttribute("vivo-font","layout-".concat(e)),s.setStyleMap(e,{"vivo-font":"[vivo-font='layout-".concat(e,"'] {font-size:").concat(.7*o,"px!important;}")})}}))}},{key:"runlayout",value:function(){return this.isAllChild?this.nodeList[0].clientHeight+i>this.parentNode.clientHeight?this.layout1():this.sumHeight<this.parentNode.clientHeight&&this.layout2():this.layout3()}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var c,v,d,s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,o;return e=t,o=[{key:"isPad",value:function(){var t=screen.height,e=screen.width;return Math.min(t,e)/Math.max(t,e)>=.8}},{key:"getStyleId",value:function(){return window.vivo_layout_style_num||(window.vivo_layout_style_num=0),++window.vivo_layout_style_num}},{key:"isZoom",value:function(t,e){if(!t&&"Text"==t.constructor.name)return!1;var n=(null==t?void 0:t.attributes)||{};return Object.values(n).find((function(t){return t.nodeName.includes(e)}))}},{key:"setStyleMap",value:function(t,e){window.vivo_layout_style_map||(window.vivo_layout_style_map={}),window.vivo_layout_style_map[t]=e}},{key:"parseNodePaddingAndMargin",value:function(t){var e=window.getComputedStyle(t);return[e.margin.split(" ").map((function(t){return.5*t.replace("px","")+"px"})).toString().replaceAll(","," "),e.padding.split(" ").map((function(t){return.5*t.replace("px","")+"px"})).toString().replaceAll(","," ")]}},{key:"zoomNode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8;t.clientHeight&&t.style.setProperty("max-height",t.clientHeight*e+"px","important")}},{key:"sameNodeListByNext",value:function(t){for(var e=t.clientHeight,n=t.clientWidth,o=t.tagName,a=[];t&&o==t.tagName&&Math.abs(t.clientHeight-e)<=i&&Math.abs(t.clientWidth-n)<=i;)a.push(t),t=t.nextElementSibling;if(a.length>1){var r=0,l=0;return a.map((function(t){return(r+=t.clientWidth)&&(l+=t.clientHeight)})),[a,a.length==a[0].parentNode.childElementCount,r,l,a[0].parentNode]}return[null,null,null,null,null]}},{key:"sameNodeList",value:function(t){var e=t.childElementCount,o=Array.from(t.children).filter((function(t){return t.clientHeight>i&&t.clientHeight<n}));if(o.length<=1)return[null,null,null,null,null];var a=o[0].clientHeight,r=o[0].tagName;if((o=o.filter((function(t){return t.tagName==r&&t.clientHeight==a}))).length>1){var l=0,u=0;return o.map((function(t){return(l+=t.clientWidth)&&(u+=t.clientHeight)})),[o,o.length==e,l,u,t]}return[null,null,null,null,null]}}],null&&u(e.prototype,null),o&&u(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}d=function(t){return t.clientWidth+a>=o&&t.clientHeight>i},(v="isFullWidth")in(c=s)?Object.defineProperty(c,v,{value:d,enumerable:!0,configurable:!0,writable:!0}):c[v]=d;var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(this,"ruleMap",{"file:///data/user/0/com.pingan.paces.ccms/files":["layout1","layout2"],"file:///data/user/0/com.ecitic.bank.mobile/files/WebResource/www/index-cube.html?pageId=28&index=SmartCube.PageNoHeader":["layout1","layout2"],"https://m.ke.com/kandian/.+.html?.+":["layout1"],"https://m.lianjia.com/kandian/.+":["layout1"]})}var e,n;return e=t,n=[{key:"getRule",value:function(t){var e=Object.keys(this.ruleMap).find((function(e){return new RegExp(e.replace("?","\\?")).test(t)}));return e?this.ruleMap[e]:[]}}],n&&y(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,i,a=[],r=!0,l=!1;try{for(n=n.call(t);!(r=(o=n.next()).done)&&(a.push(o.value),!e||a.length!==e);r=!0);}catch(t){l=!0,i=t}finally{try{r||null==n.return||n.return()}finally{if(l)throw i}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function f(){s.isPad()&&(console.log("***** enter auto layout*****"),window.vivo_start_zoom=!1,/complete/.test(document.readyState)&&function(){var t=[];function e(t,e){for(e=t.lastChild();null!=e;)e=t.lastChild();return e}function n(){var t,e=document.querySelector("style#vivo_media");e||((e=document.createElement("style")).id="vivo_media",e.setAttribute("media","only screen and (max-height : 500px), screen and (min-width : 500px)")),function n(){document.head?(document.head.appendChild(e),t&&clearInterval(interval)):t=setInterval(n,50)}()}function i(t){Object.keys(window.vivo_layout_style_map).map((function(e){var n=Object.getOwnPropertyNames(window.vivo_layout_style_map[e])[0];t.sheet.insertRule("".concat(window.vivo_layout_style_map[e][n]))}))}(function(){if(!window.vivo_start_zoom&&(t=(new p).getRule(location.href)).length){var a,r=0;!function u(){var c;a=(new Date).valueOf(),r>20?a&&clearInterval(a):(r++,(null===(c=document)||void 0===c?void 0:c.body.innerText.length)>500?(a&&clearInterval(a),console.log("\u67e5\u627e\u6b21\u6570--",r,a,document.readyState),function(){n();for(var a=document.createTreeWalker(document.body,NodeFilter.SHOW_ELEMENT,{acceptNode:function(t){return null!=t&&t.getAttribute&&t.getAttribute("vivo-layout")?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}},!1),r=a.nextNode(),u=function(){return document.querySelector("style#vivo_media")};null!=r;){if(s.isFullWidth(r)){var c=!1,v=m(s.sameNodeListByNext(r),5),d=v[0],y=v[1],p=v[2],h=v[3],f=v[4];if(!d){var g=m(s.sameNodeList(r),5);d=g[0],y=g[1],p=g[2],h=g[3],f=g[4]}if(d&&d&&p>o&&(c=new l(t,d,p,h,y,f).runlayout(),a.currentNode=d[d.length-1],e(a,a.currentNode)),!c&&r.clientHeight<=o&&r.clientHeight){var b=s.getStyleId();r.innerText&&(r.setAttribute("vivo-height","layout-".concat(b)),s.setStyleMap(b,{"vivo-height":"[vivo-height='layout-".concat(b,"'] {height:auto!important;}")}),(new l).layout4(r))}}r=a.nextNode()}(new l).zoomFont(),i(u()),window.vivo_start_zoom=!0,window.enableAdaptiveLayoutStyle=function(){if(!u()){n();var t=u();t&&i(t)}},window.disableAdaptiveLayoutStyle=function(){var t=u();t&&t.remove()}}()):(console.log("\u7ee7\u7eed\u6267\u884c",r),a=setInterval(u,80)))}()}})()}())}function g(){return window.addEventListener("resize",f),f}AutoLayout=e})();
(AutoLayout.main())();
